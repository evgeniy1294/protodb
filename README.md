# Protocol Debugger
Функциональный терминал, предназначенный для отладки, интеграции и реверс-инжиниринга аппаратных и программных средств. Встроенная поддержка языка Lua предоставляет пользователям широкие возможности в обработке и визуализации данных.

# Зависимости
* **Qt5/Qt6**;
* **Qt-Ads** - docking-система, на базе которой построен интерфейс программы. Подключена как субмодуль, установка соответствующего пакета в систему не требуется;
* **Sol3 (sol2 v3.0)** - С++ header-only обёртка над Lua, предоставляющая пользователю широчайшие возможности по работе со стеком языка;
* **Lua5 (5.4)** - реалиация стека Lua;
* **libzip** - архивы используются в механизме сессий;

# Процесс сборки (Linux)
В первую очередь необходимо клонировать проект и инициализировать субмодули:
```sh 
$ git clone https://github.com/evgeniy1294/protodb.git
$ cd ./protodb
$ git submodule init
$ git submodule update
$ cd ./libs/qt-ads
$ git checkout tags/4.0.2 -b builds
$ cd ../../
```

Далее необходимо запустить процесс сборки. Разумеется, окружение должно удовлетворять всем зависимостям. 
```sh
$ cmake ./ -B ./build -DBUILD_EXAMPLES:BOOL=OFF -DBUILD_STATIC:BOOL=ON
$ cmake --build ./build --target all -- -j8
```
_-DBUILD_EXAMPLES:BOOL=OFF -DBUILD_STATIC:BOOL=ON**_ - параметры для сборки Qt-Ads

Завершающим шагом является установка, команды ниже описывают процесс установки для пакетного менеджера pacman дистрибутива Archlinux. В независимости от дистрибутива, процесс будет очень похожим.
```sh
$ cmake --install ./build --prefix "$pkgdir/usr/"
```
_"$pkgdir/usr/"_  префикс, по которому будет произведен процесс установки. Пакетная система Archlinux использует fakeroot, при установке содержимое _pkgdir_ просто копируется в корень файловой системы.

Сборочный скрипт Qt-Ads не позволяет отключить установку библиотеки, хотя она и линкуется статически. Поэтому лишние файлы удаляются вручную:
```sh
$ rm ${pkgdir}/usr/lib/libqtadvanceddocking_static.a
$ rm -rf ${pkgdir}/usr/license/ads
$ rm -rf ${pkgdir}/usr/lib/cmake
$ rm ${pkgdir}/usr/include/*.h
```

Следующие команды завершают процесс установки. Данные команды позволяют указать путь до библиотек protodb-base, protodb-gui и protodb-dev, которые необходимы для разработки плагинов для программы, а также необходимы для её запуска. Команды подразумевают, что библиотеки уже находятся в каталоге /usr/lib/protodb
```sh
$ mkdir -p ${pkgdir}/etc/ld.so.conf.d/
$ cd ${pkgdir}/etc/ld.so.conf.d/

$echo "/usr/lib/protodb" > ./protodb.conf
```
Как автор я всячески приветствую создание полноценных пакетов для дистрибутивов Linux. Для Archlinux сборочный скрипт готов и хранится в репозитории, его публикация отложена до написания патча к cmake-скриптам Qt-Ads.

# Процесс сборки (Windows)
Процесс сборки для ОС Windows аналогичен, отличается только необходимостью предварительного создания сборочного окружения.